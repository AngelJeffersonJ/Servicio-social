{% extends "base.html" %}
{% block title %}Nuevo usuario{% endblock %}
{% block content %}
<h3 class="mb-3">Nuevo usuario</h3>

<form method="post" class="card bg-panel border-secondary p-3">
  {{ csrf_token() }}
  <div class="row g-3">
    <div class="col-md-6">
      <label class="form-label">Nombre (mostrar)</label>
      <input name="nombre" class="form-control" value="{{ (form.nombre or '') if form else '' }}" required>
    </div>
    <div class="col-md-6">
      <label class="form-label">Email</label>
      <input name="email" type="email" class="form-control" value="{{ (form.email or '') if form else '' }}" required>
    </div>

    <div class="col-md-4">
      <label class="form-label">Rol</label>
      <select name="role" class="form-select">
        {% for val, label in
        [('alumno','Alumno'),('laboratorista','Laboratorista'),('jefe','Jefe'),('admin','Administrador')] %}
        <option value="{{ val }}" {% if form and form.role==val %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Departamento (opcional)</label>
      <select name="departamento_id" class="form-select">
        <option value="">—</option>
        {% for d in departamentos %}
        <option value="{{ d.id }}" {% if form and form.departamento_id|string==d.id|string %}selected{% endif %}>{{
          d.nombre }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Contraseña</label>
      <input name="password" type="password" class="form-control" required>
    </div>

    <!-- Datos alumno -->
    <div class="col-12">
      <hr>
    </div>
    <div class="col-md-3">
      <label class="form-label">Apellido paterno</label>
      <input name="apellido_paterno" class="form-control" value="{{ (form.apellido_paterno or '') if form else '' }}">
    </div>
    <div class="col-md-3">
      <label class="form-label">Apellido materno</label>
      <input name="apellido_materno" class="form-control" value="{{ (form.apellido_materno or '') if form else '' }}">
    </div>
    <div class="col-md-3">
      <label class="form-label">No. control</label>
      <input name="no_control" class="form-control" value="{{ (form.no_control or '') if form else '' }}">
    </div>
    <div class="col-md-3">
      <label class="form-label">Carrera</label>
      <input name="carrera" class="form-control" value="{{ (form.carrera or '') if form else '' }}">
    </div>

    <!-- Datos staff -->
    <div class="col-md-6">
      <label class="form-label">Cargo / Puesto (no alumnos)</label>
      <input name="cargo" class="form-control" value="{{ (form.cargo or '') if form else '' }}">
    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-primary">Guardar</button>
    <a class="btn btn-outline-secondary" href="{{ url_for('admin.usuarios_list') }}">Volver</a>
  </div>
</form>
{% endblock %}